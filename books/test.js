!function (t, e) { "object" == typeof exports && "undefined" != typeof module ? module.exports = e() : "function" == typeof define && define.amd ? define(e) : t.watermark = e() }(this, function () { "use strict"; var extendStatics = function (t, e) { return (extendStatics = Object.setPrototypeOf || { __proto__: [] } instanceof Array && function (t, e) { t.__proto__ = e } || function (t, e) { for (var o in e) e.hasOwnProperty(o) && (t[o] = e[o]) })(t, e) }; function __extends(t, e) { function o() { this.constructor = t } extendStatics(t, e), t.prototype = null === e ? Object.create(e) : (o.prototype = e.prototype, new o) } var BaseWM = function () { function t(t) { this.DefaultFontFamily = "'PingFang SC', 'Microsoft YaHei',\n  'Helvetica Neue', Helvetica, Arial, sans-serif", this.options = t, this.options.color = this.options.color || "rgba(0, 0, 0, .07)", this.options.fontSize = this.options.fontSize || 16, this.options.fontWeight = this.options.fontWeight || "normal", this.options.fontFamily = this.options.fontFamily || this.DefaultFontFamily, this.options.invisibleColor = this.options.invisibleColor || "transparent", this.options.rotate = this.options.rotate || -20, this.options.gap = this.options.gap || 120 } return t.prototype.getActualLength = function (t) { for (var e = 0, o = 0, n = t; o < n.length; o++) { 256 <= n[o].codePointAt(0) ? e += 2 : e += 1 } return e }, t }(), CanvasWM = function (t) { function e() { return null !== t && t.apply(this, arguments) || this } return __extends(e, t), e.prototype.toDataURI = function (t) { var e = this.getActualLength(t), o = this.options, n = o.color, r = o.fontFamily, a = o.fontSize, i = o.fontWeight, c = o.gap, u = o.rotate, f = e * a / 2 + c, s = document.createElement("canvas"); s.setAttribute("width", f + "px"), s.setAttribute("height", f + "px"); var l = s.getContext("2d"); return l.translate(f / 2, f / 2), l.rotate(u * Math.PI / 180), l.fillStyle = "transparent", l.fillRect(0, 0, f, f), l.translate(-f / 2, -f / 2), l.fillStyle = "" + n, l.textBaseline = "middle", l.textAlign = "center", l.font = i + " " + a + "px  " + r, l.fillText(t, f / 2, f / 2), s.toDataURL() }, e.prototype.genStyle = function (t, e) { var o = this.toDataURI(t), n = this.getActualLength(t), r = this.options, a = n * r.fontSize / 2 + r.gap; return "\n      " + e + " {\n        background-image: url(" + o + "), url(" + o + ");\n        background-repeat: repeat, repeat;\n        background-position: " + a / 2 + "px " + a / 2 + "px, 0 0;\n      }\n    " }, e }(BaseWM), commonjsGlobal = "undefined" != typeof window ? window : "undefined" != typeof global ? global : "undefined" != typeof self ? self : {}; function createCommonjsModule(t, e) { return t(e = { exports: {} }, e.exports), e.exports } var base64 = createCommonjsModule(function (module, exports) { var R, S; R = "undefined" != typeof self ? self : "undefined" != typeof window ? window : commonjsGlobal, S = function (global) { var _Base64 = global.Base64, version = "2.4.9", buffer; if (module.exports) try { buffer = eval("require('buffer').Buffer") } catch (t) { buffer = void 0 } var b64chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/", b64tab = function (t) { for (var e = {}, o = 0, n = t.length; o < n; o++)e[t.charAt(o)] = o; return e }(b64chars), fromCharCode = String.fromCharCode, cb_utob = function (t) { if (t.length < 2) return (e = t.charCodeAt(0)) < 128 ? t : e < 2048 ? fromCharCode(192 | e >>> 6) + fromCharCode(128 | 63 & e) : fromCharCode(224 | e >>> 12 & 15) + fromCharCode(128 | e >>> 6 & 63) + fromCharCode(128 | 63 & e); var e = 65536 + 1024 * (t.charCodeAt(0) - 55296) + (t.charCodeAt(1) - 56320); return fromCharCode(240 | e >>> 18 & 7) + fromCharCode(128 | e >>> 12 & 63) + fromCharCode(128 | e >>> 6 & 63) + fromCharCode(128 | 63 & e) }, re_utob = /[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g, utob = function (t) { return t.replace(re_utob, cb_utob) }, cb_encode = function (t) { var e = [0, 2, 1][t.length % 3], o = t.charCodeAt(0) << 16 | (1 < t.length ? t.charCodeAt(1) : 0) << 8 | (2 < t.length ? t.charCodeAt(2) : 0); return [b64chars.charAt(o >>> 18), b64chars.charAt(o >>> 12 & 63), 2 <= e ? "=" : b64chars.charAt(o >>> 6 & 63), 1 <= e ? "=" : b64chars.charAt(63 & o)].join("") }, btoa = global.btoa ? function (t) { return global.btoa(t) } : function (t) { return t.replace(/[\s\S]{1,3}/g, cb_encode) }, _encode = buffer ? buffer.from && Uint8Array && buffer.from !== Uint8Array.from ? function (t) { return (t.constructor === buffer.constructor ? t : buffer.from(t)).toString("base64") } : function (t) { return (t.constructor === buffer.constructor ? t : new buffer(t)).toString("base64") } : function (t) { return btoa(utob(t)) }, encode = function (t, e) { return e ? _encode(String(t)).replace(/[+\/]/g, function (t) { return "+" == t ? "-" : "_" }).replace(/=/g, "") : _encode(String(t)) }, encodeURI = function (t) { return encode(t, !0) }, re_btou = new RegExp(["[脌-脽][聙-驴]", "[脿-茂][聙-驴]{2}", "[冒-梅][聙-驴]{3}"].join("|"), "g"), cb_btou = function (t) { switch (t.length) { case 4: var e = ((7 & t.charCodeAt(0)) << 18 | (63 & t.charCodeAt(1)) << 12 | (63 & t.charCodeAt(2)) << 6 | 63 & t.charCodeAt(3)) - 65536; return fromCharCode(55296 + (e >>> 10)) + fromCharCode(56320 + (1023 & e)); case 3: return fromCharCode((15 & t.charCodeAt(0)) << 12 | (63 & t.charCodeAt(1)) << 6 | 63 & t.charCodeAt(2)); default: return fromCharCode((31 & t.charCodeAt(0)) << 6 | 63 & t.charCodeAt(1)) } }, btou = function (t) { return t.replace(re_btou, cb_btou) }, cb_decode = function (t) { var e = t.length, o = e % 4, n = (0 < e ? b64tab[t.charAt(0)] << 18 : 0) | (1 < e ? b64tab[t.charAt(1)] << 12 : 0) | (2 < e ? b64tab[t.charAt(2)] << 6 : 0) | (3 < e ? b64tab[t.charAt(3)] : 0), r = [fromCharCode(n >>> 16), fromCharCode(n >>> 8 & 255), fromCharCode(255 & n)]; return r.length -= [0, 0, 2, 1][o], r.join("") }, atob = global.atob ? function (t) { return global.atob(t) } : function (t) { return t.replace(/[\s\S]{1,4}/g, cb_decode) }, _decode = buffer ? buffer.from && Uint8Array && buffer.from !== Uint8Array.from ? function (t) { return (t.constructor === buffer.constructor ? t : buffer.from(t, "base64")).toString() } : function (t) { return (t.constructor === buffer.constructor ? t : new buffer(t, "base64")).toString() } : function (t) { return btou(atob(t)) }, decode = function (t) { return _decode(String(t).replace(/[-_]/g, function (t) { return "-" == t ? "+" : "/" }).replace(/[^A-Za-z0-9\+\/]/g, "")) }, noConflict = function () { var t = global.Base64; return global.Base64 = _Base64, t }; if (global.Base64 = { VERSION: version, atob: atob, btoa: btoa, fromBase64: decode, toBase64: encode, utob: utob, encode: encode, encodeURI: encodeURI, btou: btou, decode: decode, noConflict: noConflict, __buffer__: buffer }, "function" == typeof Object.defineProperty) { var noEnum = function (t) { return { value: t, enumerable: !1, writable: !0, configurable: !0 } }; global.Base64.extendString = function () { Object.defineProperty(String.prototype, "fromBase64", noEnum(function () { return decode(this) })), Object.defineProperty(String.prototype, "toBase64", noEnum(function (t) { return encode(this, t) })), Object.defineProperty(String.prototype, "toBase64URI", noEnum(function () { return encode(this, !0) })) } } return global.Meteor && (Base64 = global.Base64), module.exports && (module.exports.Base64 = global.Base64), { Base64: global.Base64 } }, module.exports = S(R) }), base64_1 = base64.Base64, SvgWM = function (t) { function e() { return null !== t && t.apply(this, arguments) || this } return __extends(e, t), e.prototype.toDataURI = function (t) { var e = this.getActualLength(t), o = this.options, n = o.color, r = o.fontFamily, a = o.fontSize, i = o.fontWeight, c = e * a / 2 + o.gap, u = '\n      <svg xmlns="http://www.w3.org/2000/svg"\n        width="' + c + '" height="' + c + '"\n        style="transform: rotate(' + o.rotate + 'deg); transform-origin: 50% 50%;">\n          <text xmlns="http://www.w3.org/2000/svg"\n            x="50%" y="50%" text-anchor="middle" alignment-baseline="middle"\n            fill="' + n + '"\n            font-weight="' + i + '"\n            style="font-size: ' + a + 'px;"\n            font-family="' + r + '">\n              ' + t + "\n          </text>\n      </svg>\n    "; return "data:image/svg+xml;base64," + base64_1.encode(u) }, e.prototype.genStyle = function (t, e) { var o = this.toDataURI(t), n = this.getActualLength(t), r = this.options, a = n * r.fontSize / 2 + r.gap; return "\n      " + e + " {\n        background-image: url(" + o + "), url(" + o + ");\n        background-repeat: repeat, repeat;\n        background-position: " + a / 2 + "px " + a / 2 + "px, 0 0;\n      }\n    " }, e }(BaseWM), WatermarkType, ab; function addInlineStyle(t) { var e = document.createElement("style"); e.type = "text/css", e.innerHTML = t, document.querySelector("head").appendChild(e) } ab = WatermarkType || (WatermarkType = {}), ab.SVG = "svg", ab.CanvasWM = "canvas"; var index = function (t, e) { if (void 0 === e && (e = {}), !t) throw new Error("姘村嵃鏂囧瓧涓嶈兘涓虹┖"); e.selector = e.selector || ".watermark", e.type = e.type || WatermarkType.CanvasWM; var o = null; switch (e.type) { case WatermarkType.SVG: o = new SvgWM(e); break; case WatermarkType.CanvasWM: o = new CanvasWM(e) }addInlineStyle(o.genStyle(t, e.sel