


# 可视化表单

### 父组件，表单控件，画布,属性面板

### 数据store

redux里的store是编辑表单时的临时数据。
```js
store = {
    others:xxxx
    templates:[
        {
            tag:'xxx', //被封装好的表单组件
        	attributes:{
                id:1,
                x:500,
                y:500,
                width:500,
                height:500
               ...
        }
    ]
}
```

应用的API:

Element.getBoundingClientRect()方法返回元素的大小及其相对于视口（左上角）的位置。

### schema

schema 是每次编辑（新建或修改）结束后确定提交的数据，发送给后台，在后台存储，与后台同步。

```JSON
  
    form:[
     {
        tag:'xxx', //被封装好的表单组件
        attributes:{
                id:1,
                x:500,
                y:500,
                width:500,
                height:500
                ...
        }
        
     }
    ]
```

**拖拽逻辑：**

应用的API:

drag

点击某个控件按钮，在鼠标位置生成控件图标进行拖拽，监听drag事件，当进入画布后，将鼠标所在位置与store里的对象位置进行比较，在x1< x < x2, y1 < y < y2 中间生成新的组件对象数据（divider放在这里），当鼠标移动后，对divider在对象的位置进行相应修改，当dragend触发后，更换divider的数据内容，根据表单控件传递给父组件再传递给表单正文的组件数组参数生成新数据（对象在store的位置不变）。画布内的空间可以进行上下拖动，监听逻辑和前面一样，只是还要删除store里原本位置的元素。

**控件设置逻辑：**

首先属性面板里的公共项可以抽出来作为一个公用的class 用于继承。点击表单控件里的某个选项，tag和id（index）传给父组件，再传给属性组件，继承基本class，再根据参数通过HOC生成特定的设置。设置的数据被store存储， 每改变一个设置都应该通知store进行更新


## 基本组件：

单行输入框（文本，数字，金额），多行输入框，多选框，单选框，下拉单选，下拉多选，时间选择，时间区选择，地址输入，成员选择，部门选择，岗位选择

组件应该制定好：基本样式，内在的state（如默认值）和内在的数据请求

